<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../paper-dialog/paper-dialog.html">
<link rel="import" href="../../paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../../paper-listbox/paper-listbox.html">
<link rel="import" href="../../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../paper-input/paper-input.html">
<link rel="import" href="../../paper-button/paper-button.html">
<link rel="import" href="../../paper-item/paper-item.html">
<link rel="import" href="../pf-calendar.html">

<!--
`pf-calendar`


@demo demo/index.html
-->

<dom-module id="test-ele">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>

        <style is="custom-style">





        </style>

        <pf-calendar id="mycal" databasename="pf-calendar-firebase"  databasepath="testdata" ></pf-calendar>
        <paper-dialog class="content" id="eveDialog" >
            <paper-input class="paperInput" id="EventName" label="Event Name" required auto-validate
                          error-message="Enter Event Name" char-counter></paper-input>
            <paper-input class="paperInput" id="EventDesc"  label="Event Description"
                         value="" char-counter></paper-input>
            <paper-input class="paperInput" id="EventCat"  label="Event Category"
                         value="" char-counter></paper-input>
            <paper-input class="paperInput" id="EventColor"  label="Event Color" required auto-validate
                         value="" char-counter></paper-input>
         <!--
            <paper-dropdown-menu id="eventColor" label="Color" vertical-align="bottom"
                                       horizontal-align="left">
                <paper-listbox class="dropdown-content"  attr-for-selected="label">
                    <paper-item label="blue">Blue</paper-item>
                    <paper-item label="orange">Orange</paper-item>
                    <paper-item label="green">Green</paper-item>
                    <paper-item label="yellow">Yellow</paper-item>
                </paper-listbox>
            </paper-dropdown-menu>
-->
            <paper-button on-tap="_AddNewEvent" autofocus>Submit</paper-button>
            <paper-button dialog-dismiss>Cancel</paper-button>
        </paper-dialog>
    </template>

    <script>
        class TestEle extends Polymer.Element {
            static get is() { return 'test-ele'; }
            static get properties() {
                return {
                    prop1: {
                        type: String,
                        value: 'test-ele'
                    },
                    date: {
                        type: Object
                    },
                    calendarstyle:{
                        type:String
                    }, eventsdata:{
                        type:Object
                    }

                };
            }
            ready() {
                super.ready();
                this.$.mycal.addEventListener('date-select', e => this._date(e)
            );
                this.$.mycal.addEventListener('event-select', e => this._handleClick(e)
            );
                this.$.mycal.addEventListener('event-edit', e => this._handleEvent(e)
            );
                this.$.mycal.addEventListener('event-delete', e => this._handleEvent(e)
            );
                this.$.mycal.addEventListener('event-add', e => this._addEvent(e)
            );
            }
            _addEvent(e) {
                this.$.eveDialog.open()
                var selectedDate = e.detail.date
                this.date=moment(selectedDate).valueOf()
            }
            _AddNewEvent(){
                var validation = true

                if (!this.$.EventName.validate()) {
                    validation = false
                }
                if (!this.$.EventCat.validate()) {
                    validation = false
                }
                if (!this.$.EventColor.validate()) {
                    validation = false
                }

                if (validation) {
                    var mData = {
                        eventName:this.$.EventName.value,
                        category:this.$.EventCat.value,
                        color:this.$.EventColor.value,
                        date:this.date,
                        description:this.$.EventDesc.value

                    }
                    this.$.mycal.addNewEvent(mData);
                    this.$.eveDialog.close()
                }
            }
            _date(e) {
                var day = e.detail.date;
                var eve = e.detail.events;
            }
            _handleClick(e) {
                var eve = e.detail.event
            }
            _handleEvent(e){
                var event = e.detail.event
            }
        }

        window.customElements.define(TestEle.is, TestEle);
    </script>
</dom-module>
